---
import Layout from "../layouts/Layout.astro";

const galeria = [
    { src: "/galeria/ica.avif", alt: "Ica", titulo: "Ica", categoria: "Ica" },
  	{ src: "/galeria/ica1.avif", alt: "Ica", titulo: "Ica", categoria: "Ica" },
  	{ src: "/galeria/ica2.avif", alt: "Ica", titulo: "Ica", categoria: "Ica" },
  	{ src: "/galeria/ica3.avif", alt: "Ica", titulo: "Ica", categoria: "Ica" },
  	{ src: "/galeria/ica4.avif", alt: "Ica", titulo: "Ica", categoria: "Ica" },
  	{ src: "/galeria/ica5.avif", alt: "Ica", titulo: "Ica", categoria: "Ica" },
  	{ src: "/galeria/ica6.avif", alt: "Ica", titulo: "Ica", categoria: "Ica" },
  	{ src: "/galeria/ica7.avif", alt: "Ica", titulo: "Ica", categoria: "Ica" },
  	{ src: "/galeria/ica8.avif", alt: "Ica", titulo: "Ica", categoria: "Ica" },
  	{ src: "/galeria/ica9.avif", alt: "Ica", titulo: "Ica", categoria: "Ica" },
  	{ src: "/galeria/city-tour.avif", alt: "City Tours", titulo: "City Tours", categoria: "City Tours" },
	{ src: "/galeria/city-tour1.avif", alt: "City Tours", titulo: "City Tours", categoria: "City Tours" },
	{ src: "/galeria/city-tour2.avif", alt: "City Tours", titulo: "City Tours", categoria: "City Tours" },
	{ src: "/galeria/city-tour3.avif", alt: "City Tours", titulo: "City Tours", categoria: "City Tours" },
	{ src: "/galeria/city-tour4.avif", alt: "City Tours", titulo: "City Tours", categoria: "City Tours" },
	{ src: "/galeria/city-tour5.avif", alt: "City Tours", titulo: "City Tours", categoria: "City Tours" },
	{ src: "/galeria/city-tour6.avif", alt: "City Tours", titulo: "City Tours", categoria: "City Tours" },
	{ src: "/galeria/city-tour7.avif", alt: "City Tours", titulo: "City Tours", categoria: "City Tours" },
	{ src: "/galeria/city-tour8.avif", alt: "City Tours", titulo: "City Tours", categoria: "City Tours" },
	{ src: "/galeria/city-tour9.avif", alt: "City Tours", titulo: "City Tours", categoria: "City Tours" },
	{ src: "/galeria/city-tour10.avif", alt: "City Tours", titulo: "City Tours", categoria: "City Tours" },
	{ src: "/galeria/city-tour11.avif", alt: "City Tours", titulo: "City Tours", categoria: "City Tours" },
	{ src: "/galeria/city-tour12.avif", alt: "City Tours", titulo: "City Tours", categoria: "City Tours" },
	{ src: "/galeria/city-tour13.avif", alt: "City Tours", titulo: "City Tours", categoria: "City Tours" },
	{ src: "/galeria/city-tour14.avif", alt: "City Tours", titulo: "City Tours", categoria: "City Tours" },
	{ src: "/galeria/city-tour15.avif", alt: "City Tours", titulo: "City Tours", categoria: "City Tours" },
	{ src: "/galeria/city-tour16.avif", alt: "City Tours", titulo: "City Tours", categoria: "City Tours" },
	{ src: "/galeria/city-tour17.avif", alt: "City Tours", titulo: "City Tours", categoria: "City Tours" },
	{ src: "/galeria/laguna.avif", alt: "Laguna Ausangate", titulo:"Laguna Ausangate", categoria:"Laguna Ausangate"},
	{ src: "/galeria/laguna1.avif", alt: "Laguna Ausangate", titulo:"Laguna Ausangate", categoria:"Laguna Ausangate"},
	{ src: "/galeria/laguna2.avif", alt: "Laguna Ausangate", titulo:"Laguna Ausangate", categoria:"Laguna Ausangate"},
	{ src: "/galeria/laguna3.avif", alt: "Laguna Ausangate", titulo:"Laguna Ausangate", categoria:"Laguna Ausangate"},
	{ src: "/galeria/laguna4.avif", alt: "Laguna Ausangate", titulo:"Laguna Ausangate", categoria:"Laguna Ausangate"},
	{ src: "/galeria/laguna5.avif", alt: "Laguna Ausangate", titulo:"Laguna Ausangate", categoria:"Laguna Ausangate"},
	{ src: "/galeria/machu-picchu.avif", alt: "Machu Picchu", titulo:"Machu Picchu", categoria:"Machu Picchu"},
	{ src: "/galeria/machu-picchu1.avif", alt: "Machu Picchu", titulo:"Machu Picchu", categoria:"Machu Picchu"},
	{ src: "/galeria/machu-picchu2.avif", alt: "Machu Picchu", titulo:"Machu Picchu", categoria:"Machu Picchu"},
	{ src: "/galeria/machu-picchu3.avif", alt: "Machu Picchu", titulo:"Machu Picchu", categoria:"Machu Picchu"},
	{ src: "/galeria/machu-picchu4.avif", alt: "Machu Picchu", titulo:"Machu Picchu", categoria:"Machu Picchu"},
	{ src: "/galeria/machu-picchu5.avif", alt: "Machu Picchu", titulo:"Machu Picchu", categoria:"Machu Picchu"},
	{ src: "/galeria/machu-picchu6.avif", alt: "Machu Picchu", titulo:"Machu Picchu", categoria:"Machu Picchu"},
	{ src: "/galeria/machu-picchu7.avif", alt: "Machu Picchu", titulo:"Machu Picchu", categoria:"Machu Picchu"},
	{ src: "/galeria/machu-picchu8.avif", alt: "Machu Picchu", titulo:"Machu Picchu", categoria:"Machu Picchu"},
	{ src: "/galeria/machu-picchu9.avif", alt: "Machu Picchu", titulo:"Machu Picchu", categoria:"Machu Picchu"},
	{ src: "/galeria/machu-picchu10.avif", alt: "Machu Picchu", titulo:"Machu Picchu", categoria:"Machu Picchu"},
	{ src: "/galeria/machu-picchu11.avif", alt: "Machu Picchu", titulo:"Machu Picchu", categoria:"Machu Picchu"},
	{ src: "/galeria/machu-picchu12.avif", alt: "Machu Picchu", titulo:"Machu Picchu", categoria:"Machu Picchu"},
	{ src: "/galeria/machu-picchu13.avif", alt: "Machu Picchu", titulo:"Machu Picchu", categoria:"Machu Picchu"},
	{ src: "/galeria/machu-picchu14.avif", alt: "Machu Picchu", titulo:"Machu Picchu", categoria:"Machu Picchu"},
	{ src: "/galeria/machu-picchu15.avif", alt: "Machu Picchu", titulo:"Machu Picchu", categoria:"Machu Picchu"},
	{ src: "/galeria/machu-picchu16.avif", alt: "Machu Picchu", titulo:"Machu Picchu", categoria:"Machu Picchu"},
	{ src: "/galeria/machu-picchu17.avif", alt: "Machu Picchu", titulo:"Machu Picchu", categoria:"Machu Picchu"},
	{ src: "/galeria/machu-picchu18.avif", alt: "Machu Picchu", titulo:"Machu Picchu", categoria:"Machu Picchu"},
	{ src: "/galeria/machu-picchu19.avif", alt: "Machu Picchu", titulo:"Machu Picchu", categoria:"Machu Picchu"},
	{ src: "/galeria/machu-picchu20.avif", alt: "Machu Picchu", titulo:"Machu Picchu", categoria:"Machu Picchu"},
	{ src: "/galeria/machu-picchu21.avif", alt: "Machu Picchu", titulo:"Machu Picchu", categoria:"Machu Picchu"},
	{ src: "/galeria/machu-picchu22.avif", alt: "Machu Picchu", titulo:"Machu Picchu", categoria:"Machu Picchu"},
	{ src: "/galeria/machu-picchu23.avif", alt: "Machu Picchu", titulo:"Machu Picchu", categoria:"Machu Picchu"},
	{ src: "/galeria/machu-picchu24.avif", alt: "Machu Picchu", titulo:"Machu Picchu", categoria:"Machu Picchu"},
	{ src: "/galeria/machu-picchu25.avif", alt: "Machu Picchu", titulo:"Machu Picchu", categoria:"Machu Picchu"},
	{ src: "/galeria/machu-picchu26.avif", alt: "Machu Picchu", titulo:"Machu Picchu", categoria:"Machu Picchu"},
	{ src: "/galeria/montana.avif", alt: "Montaña 7 Colores", titulo:"Montaña 7 Colores", categoria:"Montaña 7 Colores"},
	{ src: "/galeria/montana1.avif", alt: "Montaña 7 Colores", titulo:"Montaña 7 Colores", categoria:"Montaña 7 Colores"},
	{ src: "/galeria/montana2.avif", alt: "Montaña 7 Colores", titulo:"Montaña 7 Colores", categoria:"Montaña 7 Colores"},
	{ src: "/galeria/montana3.avif", alt: "Montaña 7 Colores", titulo:"Montaña 7 Colores", categoria:"Montaña 7 Colores"},
	{ src: "/galeria/montana4.avif", alt: "Montaña 7 Colores", titulo:"Montaña 7 Colores", categoria:"Montaña 7 Colores"},
	{ src: "/galeria/montana5.avif", alt: "Montaña 7 Colores", titulo:"Montaña 7 Colores", categoria:"Montaña 7 Colores"},
	{ src: "/galeria/montana6.avif", alt: "Montaña 7 Colores", titulo:"Montaña 7 Colores", categoria:"Montaña 7 Colores"},
	{ src: "/galeria/montana7.avif", alt: "Montaña 7 Colores", titulo:"Montaña 7 Colores", categoria:"Montaña 7 Colores"},
	{ src: "/galeria/montana8.avif", alt: "Montaña 7 Colores", titulo:"Montaña 7 Colores", categoria:"Montaña 7 Colores"},
	{ src: "/galeria/montana9.avif", alt: "Montaña 7 Colores", titulo:"Montaña 7 Colores", categoria:"Montaña 7 Colores"},
	{ src: "/galeria/montana10.avif", alt: "Montaña 7 Colores", titulo:"Montaña 7 Colores", categoria:"Montaña 7 Colores"},
	{ src: "/galeria/valle-sagrado.avif", alt: "Valle Sagrado", titulo:"Valle Sagrado", categoria:"Valle Sagrado"},
	{ src: "/galeria/valle-sagrado1.avif", alt: "Valle Sagrado", titulo:"Valle Sagrado", categoria:"Valle Sagrado"},
	{ src: "/galeria/valle-sagrado2.avif", alt: "Valle Sagrado", titulo:"Valle Sagrado", categoria:"Valle Sagrado"},
	{ src: "/galeria/valle-sagrado3.avif", alt: "Valle Sagrado", titulo:"Valle Sagrado", categoria:"Valle Sagrado"},
	{ src: "/galeria/valle-sagrado4.avif", alt: "Valle Sagrado", titulo:"Valle Sagrado", categoria:"Valle Sagrado"},
	{ src: "/galeria/valle-sagrado5.avif", alt: "Valle Sagrado", titulo:"Valle Sagrado", categoria:"Valle Sagrado"},
	{ src: "/galeria/valle-sagrado6.avif", alt: "Valle Sagrado", titulo:"Valle Sagrado", categoria:"Valle Sagrado"},
	{ src: "/galeria/valle-sagrado7.avif", alt: "Valle Sagrado", titulo:"Valle Sagrado", categoria:"Valle Sagrado"},
	{ src: "/galeria/valle-sagrado8.avif", alt: "Valle Sagrado", titulo:"Valle Sagrado", categoria:"Valle Sagrado"},
	{ src: "/galeria/valle-sagrado9.avif", alt: "Valle Sagrado", titulo:"Valle Sagrado", categoria:"Valle Sagrado"},
	{ src: "/galeria/valle-sagrado10.avif", alt: "Valle Sagrado", titulo:"Valle Sagrado", categoria:"Valle Sagrado"},
	{ src: "/galeria/valle-sagrado11.avif", alt: "Valle Sagrado", titulo:"Valle Sagrado", categoria:"Valle Sagrado"},
	{ src: "/galeria/valle-sagrado12.avif", alt: "Valle Sagrado", titulo:"Valle Sagrado", categoria:"Valle Sagrado"},
	{ src: "/galeria/valle-sagrado13.avif", alt: "Valle Sagrado", titulo:"Valle Sagrado", categoria:"Valle Sagrado"},
	{ src: "/galeria/valle-sagrado14.avif", alt: "Valle Sagrado", titulo:"Valle Sagrado", categoria:"Valle Sagrado"},
	{ src: "/galeria/valle-sagrado15.avif", alt: "Valle Sagrado", titulo:"Valle Sagrado", categoria:"Valle Sagrado"},
	{ src: "/galeria/valle-sagrado16.avif", alt: "Valle Sagrado", titulo:"Valle Sagrado", categoria:"Valle Sagrado"},
	{ src: "/galeria/valle-sagrado17.avif", alt: "Valle Sagrado", titulo:"Valle Sagrado", categoria:"Valle Sagrado"},
	{ src: "/galeria/valle-sagrado18.avif", alt: "Valle Sagrado", titulo:"Valle Sagrado", categoria:"Valle Sagrado"},
	{ src: "/galeria/valle-sagrado19.avif", alt: "Valle Sagrado", titulo:"Valle Sagrado", categoria:"Valle Sagrado"},
	{ src: "/galeria/valle-sagrado20.avif", alt: "Valle Sagrado", titulo:"Valle Sagrado", categoria:"Valle Sagrado"},
	{ src: "/galeria/valle-sagrado21.avif", alt: "Valle Sagrado", titulo:"Valle Sagrado", categoria:"Valle Sagrado"},
	{ src: "/galeria/valle-sagrado22.avif", alt: "Valle Sagrado", titulo:"Valle Sagrado", categoria:"Valle Sagrado"},
	{ src: "/galeria/valle-sagrado23.avif", alt: "Valle Sagrado", titulo:"Valle Sagrado", categoria:"Valle Sagrado"},
	{ src: "/galeria/valle-sagrado24.avif", alt: "Valle Sagrado", titulo:"Valle Sagrado", categoria:"Valle Sagrado"},
	{ src: "/galeria/valle-sagrado25.avif", alt: "Valle Sagrado", titulo:"Valle Sagrado", categoria:"Valle Sagrado"},
	{ src: "/galeria/walking-tour.avif", alt: "Walking Tours", titulo:"Walking Tours", categoria:"Walking Tours"},
	{ src: "/galeria/walking-tour1.avif", alt: "Walking Tours", titulo:"Walking Tours", categoria:"Walking Tours"},
	{ src: "/galeria/walking-tour2.avif", alt: "Walking Tours", titulo:"Walking Tours", categoria:"Walking Tours"},
	{ src: "/galeria/walking-tour3.avif", alt: "Walking Tours", titulo:"Walking Tours", categoria:"Walking Tours"},
	{ src: "/galeria/walking-tour4.avif", alt: "Walking Tours", titulo:"Walking Tours", categoria:"Walking Tours"},
	{ src: "/galeria/walking-tour5.avif", alt: "Walking Tours", titulo:"Walking Tours", categoria:"Walking Tours"},
	{ src: "/galeria/walking-tour6.avif", alt: "Walking Tours", titulo:"Walking Tours", categoria:"Walking Tours"},
	{ src: "/galeria/walking-tour7.avif", alt: "Walking Tours", titulo:"Walking Tours", categoria:"Walking Tours"},
];

const categorias = ["Todos", "Ica", "City Tours", "Laguna Ausangate", "Machu Picchu", "Montaña 7 Colores", "Valle Sagrado", "Walking Tours"];
---

<Layout>
  	<!-- HERO -->
  	<section class="relative">
    	<div class="relative h-[70vh] md:h-[80vh] rounded-b-3xl overflow-hidden shadow-lg" style={`background-image: url('/bg-cusco.avif'); background-size: cover; background-position: center;`}>
      		<div class="absolute inset-0 bg-gradient-to-b from-black/70 via-black/60 to-black/70"></div>
      		<div class="absolute inset-0 flex flex-col items-center justify-center text-center px-6">
        		<h1 class="font-extrabold text-white drop-shadow-lg text-[clamp(1.8rem,4vw,3.2rem)]">
          			Galería de Experiencias
        		</h1>
        		<p class="mt-3 text-white/80 max-w-2xl text-[clamp(0.9rem,2vw,1.2rem)]">
          			Descubre los momentos más memorables de nuestros tours en Cusco, Ica y Lima.
        		</p>
      		</div>
    	</div>
  	</section>

  	<!-- FILTROS -->
  	<section class="py-8 bg-gray-100">
    	<div class="max-w-5xl mx-auto px-6 text-center flex flex-wrap justify-center gap-3">
      		{categorias.map((cat, i) => (
        		<button type="button" class={`filter-btn px-5 py-2 rounded-full border font-medium transition-all duration-300 ${i === 0 ? "bg-green-800 text-white border-green-800" : "bg-white text-green-800 border-green-800 hover:bg-green-700 hover:text-white"}`} data-filter={cat}>
          			{cat}
        		</button>
      		))}
    	</div>
  	</section>

  	<!-- GALERÍA -->
  	<section class="py-16 bg-gray-50">
    	<div class="max-w-7xl mx-auto px-6">
      		<h2 class="text-3xl md:text-4xl font-bold text-green-900 text-center mb-12">
        		Momentos Inolvidables
      		</h2>

      		<div id="galleryGrid" class="grid gap-4 grid-cols-[repeat(auto-fill,minmax(220px,1fr))]">
        		{galeria.map((foto, index) => (
          			<div class="gallery-item relative group rounded-lg overflow-hidden shadow hover:shadow-2xl transition cursor-pointer w-full" data-index={index} data-categoria={foto.categoria} data-src={foto.src} data-titulo={foto.titulo}>
            			<img src={foto.src} alt={foto.alt} class="w-full h-48 object-cover rounded-lg transform group-hover:scale-105 transition duration-500" loading="lazy"/>
            			<div class="absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 flex items-center justify-center transition">
              				<span class="text-white text-lg font-semibold drop-shadow">{foto.titulo}</span>
            			</div>
          			</div>
        		))}
      		</div>
    	</div>
  	</section>

  	<!-- MODAL -->
	<div id="modal" class="fixed inset-0 bg-black/90 hidden items-center justify-center z-50 p-4">
		<button id="modalClose" class="absolute top-6 right-6 text-white text-3xl">
			<i class="fa-solid fa-xmark"></i>
		</button>

  		<!-- Imagen principal con animación -->
  		<div class="max-w-[90vw] max-h-[80vh] flex flex-col items-center relative">
			<button id="prevBtn" class="absolute left-[-3rem] top-1/2 -translate-y-1/2 text-white text-4xl">
				<i class="fa-solid fa-chevron-left"></i>
			</button>
    		<img id="modalImage" class="max-h-[70vh] max-w-full rounded-lg shadow-lg mb-4 transform transition duration-500 scale-95 opacity-0" alt="Imagen ampliada" />
			<button id="nextBtn" class="absolute right-[-3rem] top-1/2 -translate-y-1/2 text-white text-4xl">
				<i class="fa-solid fa-chevron-right"></i>
			</button>
    		<p id="modalCaption" class="text-white text-lg text-center"></p>
  		</div>
	</div>

	<!-- SCRIPT -->
	<script is:inline>
  		const modal = document.getElementById("modal");
  		const modalImage = document.getElementById("modalImage");
  		const modalCaption = document.getElementById("modalCaption");
  		const modalClose = document.getElementById("modalClose");
  		const galleryItems = document.querySelectorAll(".gallery-item");
  		const filterButtons = document.querySelectorAll(".filter-btn");
  		const prevBtn = document.getElementById("prevBtn");
  		const nextBtn = document.getElementById("nextBtn");

  		let currentIndex = 0;
  		const images = Array.from(galleryItems).map(item => ({
    		src: item.dataset.src,
    		titulo: item.dataset.titulo,
  		}));

  		// Pre-cargar imágenes
  		function preloadImages() {
    		images.forEach(img => {
      			const preload = new Image();
      			preload.src = img.src;
    		});
  		}

  		function openModal(index) {
    		currentIndex = index;
    		preloadImages();
    		updateModal();
    		modal.classList.remove("hidden");
    		modal.classList.add("flex");
    		document.documentElement.style.overflow = "hidden";
  		}

  		function closeModal() {
    		modal.classList.add("hidden");
    		modal.classList.remove("flex");
    		modalImage.classList.remove("opacity-100","scale-100");
    		modalImage.classList.add("opacity-0","scale-95");
    		document.documentElement.style.overflow = "";
  		}

  		function updateModal() {
    		const { src, titulo } = images[currentIndex];
    		modalImage.src = src;
    		modalCaption.textContent = titulo;
    		// animación de entrada
    		modalImage.classList.remove("opacity-0","scale-95");
    		modalImage.classList.add("opacity-100","scale-100");
  		}

  		// Eventos
  		galleryItems.forEach((item, index) => {
    		item.addEventListener("click", () => openModal(index));
  		});
  		modalClose.addEventListener("click", closeModal);
  		modal.addEventListener("click", ev => {
  			if (ev.target.id === "modal") { 
    			closeModal(); 
  			}
		});
  		document.addEventListener("keydown", ev => {
    		if (ev.key === "Escape") closeModal();
    		if (ev.key === "ArrowRight") nextImage();
    		if (ev.key === "ArrowLeft") prevImage();
  		});
  		nextBtn.addEventListener("click", nextImage);
  		prevBtn.addEventListener("click", prevImage);

  		function nextImage() {
    		currentIndex = (currentIndex + 1) % images.length;
    		updateModal();
  		}
  		function prevImage() {
    		currentIndex = (currentIndex - 1 + images.length) % images.length;
    		updateModal();
  		}

  		// Filtros
  		filterButtons.forEach(btn => {
    		btn.addEventListener("click", () => {
      			const filter = btn.dataset.filter;
      			galleryItems.forEach(item => {
        			if (filter === "Todos" || item.dataset.categoria === filter) {
          				item.classList.remove("hidden");
        			} else {
          				item.classList.add("hidden");
        			}
      			});
      			filterButtons.forEach(b => b.className = "filter-btn px-5 py-2 rounded-full border font-medium transition-all duration-300 bg-white text-green-800 border-green-800 hover:bg-green-700 hover:text-white");
      			btn.className = "filter-btn px-5 py-2 rounded-full border font-medium transition-all duration-300 bg-green-800 text-white border-green-800";
    		});
  		});
	</script>
</Layout>